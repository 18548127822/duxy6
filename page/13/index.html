<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>欢迎来到我的世界。 - Duxy</title><meta name="author" content="Darius"><meta name="copyright" content="Darius"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta property="og:type" content="website">
<meta property="og:title" content="欢迎来到我的世界。">
<meta property="og:url" content="http://blog.duxy6.com/page/13/index.html">
<meta property="og:site_name" content="欢迎来到我的世界。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://duxy.oss-cn-shanghai.aliyuncs.com/logo_bk.png">
<meta property="article:author" content="Darius">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://duxy.oss-cn-shanghai.aliyuncs.com/logo_bk.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://blog.duxy6.com/page/13/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '欢迎来到我的世界。',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2022-06-14 13:28:59'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.2"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://duxy.oss-cn-shanghai.aliyuncs.com/logo_bk.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">232</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">21</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">35</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/index.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">欢迎来到我的世界。</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">欢迎来到我的世界。</h1></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2019/05/05/CICD/jenkins%E7%9A%84%E5%88%86%E5%B8%83%E5%BC%8F/Jenkins%E5%88%86%E5%B8%83%E5%BC%8F%E9%83%A8%E7%BD%B2/" title="Jenkins分布式部署">     <img class="post_bg" src="/images/jenkins.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Jenkins分布式部署"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/05/05/CICD/jenkins%E7%9A%84%E5%88%86%E5%B8%83%E5%BC%8F/Jenkins%E5%88%86%E5%B8%83%E5%BC%8F%E9%83%A8%E7%BD%B2/" title="Jenkins分布式部署">Jenkins分布式部署</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2019-05-05T01:40:00.000Z" title="发表于 2019-05-05 09:40:00">2019-05-05</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/CICD/">CICD</a></span></div><div class="content">单台的job数量是有上线的，单台jenkins执行几十上百速度就会慢，此时就会部署一个Master多个node节点，master上配置多个任务，nodes上去执行各个任务，或者让测试环境的job执行在测试的node节点上，生产的job执行在生产的node上及那个其分离开。
node节点在执行job时会先去gitlab上拉取代码，对其进行编译，编译完成打包后向后端web服务器去部署，master不再执行操作，只用来分配各种job。
分布式Jenkins配置方式jenkins配置分布式前提条件
1.确保slave的时间必须要和master的时间相同
2.slave上的java环境需要和master上相同
环境准备



hostname
ip
os



master
192.168.27.12
ubuntu 18.04.2


slave-1
192.168.27.13
ubuntu 18.04.2


slave-2
192.168.27.14
ubuntu 18.04.2


在所有的服务器上进行时间同步
1ntpdate 172.20.0.1
配置2台slave的java环境配置j ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2019/05/04/CICD/jenkins%E7%9A%84pipline/jenkins%E7%9A%84pipline/" title="Jenkins的pipline">     <img class="post_bg" src="/images/jenkins.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Jenkins的pipline"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/05/04/CICD/jenkins%E7%9A%84pipline/jenkins%E7%9A%84pipline/" title="Jenkins的pipline">Jenkins的pipline</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2019-05-04T01:30:00.000Z" title="发表于 2019-05-04 09:30:00">2019-05-04</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/CICD/">CICD</a></span></div><div class="content">pipline简介官方介绍；https://jenkins.io/2.0/
pipline是帮助Jenkins实现CI到CD转变的重要角色，是运行在jenkins2.X版本的核心插件，简单来说Pipline就是一套运行于Jenkins上的工作流框架，将原本独立运行于单个或者多个节点的任务连接起来，实现单个任务难以完成的复杂发布流程，从而实现单个任务很难实现的复杂流程编排和任务可视化，pipline的实现方式是一套Groovy DSL，任何发布流程都可以表述为一段Groovy脚本。
pipline语法Stage：阶段，一个pipline可以划分为若干个stage，每个stage都是一个操作，比如clone代码、代码编译、代码测试和代码部署，阶段是一个逻辑分组，可以跨多个node执行。
Node：节点，每个node都是一个jenkins节点，可以是jenkin smaster也可以是jenkins agent，node是执行step的具体服务器。
Step：步骤，step是jenkinspipline最基本的操作单元，从在服务器创建目录到构建容器镜像，由各类Jenkins插件提供实现，例如 ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2019/05/04/CICD/jenkins%E8%A7%A6%E5%8F%91%E5%99%A8/Jenkins%E6%9E%84%E5%BB%BA%E8%A7%A6%E5%8F%91%E5%99%A8/" title="Jenkins构建触发器">     <img class="post_bg" src="/images/jenkins.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Jenkins构建触发器"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/05/04/CICD/jenkins%E8%A7%A6%E5%8F%91%E5%99%A8/Jenkins%E6%9E%84%E5%BB%BA%E8%A7%A6%E5%8F%91%E5%99%A8/" title="Jenkins构建触发器">Jenkins构建触发器</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2019-05-04T01:30:00.000Z" title="发表于 2019-05-04 09:30:00">2019-05-04</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/CICD/">CICD</a></span></div><div class="content">当gitlab上代码发生变更时，jenkins自动将代码部署到服务器上，常用于测试环境
实现方法在gitlab上创建一个新的开发分支


在jenkins上安装插件


插件安装完毕后需要对jenkins的配置做一些更改：
1.允许登录用户可以做任何事情
2.关闭跨站伪造保护


新建一个开发分支的任务

生成一个token值
12root@jenkins:~# openssl rand -hex 122d6f3d9475277d20545a4182

填入token值



测试访问连接
12#jenkins的地址、job和token拼出的连接，一旦访问此连接将触发构建root@jenkins:~# curl 192.168.27.12:8080/job/mylinu_develop/build?token=2d6f3d9475277d20545a4182

url测试通过后将其写入gitlab


在Jenkins上修改构建的脚本

测试对开发分克隆
123456789root@gitlab:~# git clone -b develop http://192.168.27.11/ ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2019/05/04/CICD/jenkins+gitlab/jenkins+gitlab/" title="Jenkins+Gitlab实现代码自动部署">     <img class="post_bg" src="/images/jenkins.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Jenkins+Gitlab实现代码自动部署"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/05/04/CICD/jenkins+gitlab/jenkins+gitlab/" title="Jenkins+Gitlab实现代码自动部署">Jenkins+Gitlab实现代码自动部署</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2019-05-04T01:20:00.000Z" title="发表于 2019-05-04 09:20:00">2019-05-04</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/CICD/">CICD</a></span></div><div class="content">环境准备


Hostname
Server
IP
OS



gitlab
Gitlab
192.168.27.11
ubuntu 18.04.2


jenkins
Jenkins
192.168.27.12
ubuntu 18.04.2


haproxy-1
haproxy
192.168.27.21
ubuntu 18.04.2


haproxy-2
haproxy
192.168.27.22
ubuntu 18.04.2


tomcat-1
tomcat
192.168.27.31
ubuntu 18.04.2


tomcat-2
tomcat
192.168.27.32
ubuntu 18.04.2



安装jdk环境分别在jenkins、tomcat-1、tomcat-2主机上安装jdk环境
oracle官网下载jdk，上传到本地服务器
12root@jenkins:~# lsjdk-8u212-linux-x64.tar.gz

解压jdk到/usr/local/src目录下，做一个软连接
12tar xf jdk-8u212-linux-x64.tar.gz ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2019/05/03/CICD/gitlab/gitlab%E6%95%B0%E6%8D%AE%E5%A4%87%E4%BB%BD/gitlab%E6%95%B0%E6%8D%AE%E5%A4%87%E4%BB%BD%E5%92%8C%E6%81%A2%E5%A4%8D/" title="GitLab数据备份和恢复">     <img class="post_bg" src="/images/gitlab.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="GitLab数据备份和恢复"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/05/03/CICD/gitlab/gitlab%E6%95%B0%E6%8D%AE%E5%A4%87%E4%BB%BD/gitlab%E6%95%B0%E6%8D%AE%E5%A4%87%E4%BB%BD%E5%92%8C%E6%81%A2%E5%A4%8D/" title="GitLab数据备份和恢复">GitLab数据备份和恢复</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2019-05-03T02:30:00.000Z" title="发表于 2019-05-03 10:30:00">2019-05-03</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/CICD/">CICD</a></span></div><div class="content">gitlab的数据目录在/var/opt/gitlab目录下
1234567891011121314151617181920212223242526root@duxy6:~# ll /var/opt/gitlab/total 96drwxr-xr-x 20 root              root       4096 Jul 18 11:48 ./drwxr-xr-x  3 root              root       4096 Jul 18 11:46 ../drwxr-x---  3 gitlab-prometheus root       4096 Jul 18 11:48 alertmanager/drwx------  2 git               root       4096 Jul 18 11:46 backups/-rw-------  1 root              root         38 Jul 18 11:48 bootstrappeddrwxr-xr-x  2 git               git        ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2019/05/03/CICD/gitlab/git%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/git%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/" title="Git常用命令">     <img class="post_bg" src="/images/gitlab.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Git常用命令"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/05/03/CICD/gitlab/git%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/git%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/" title="Git常用命令">Git常用命令</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2019-05-03T02:20:00.000Z" title="发表于 2019-05-03 10:20:00">2019-05-03</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/CICD/">CICD</a></span></div><div class="content">git基本使用1.克隆
123456root@duxy6:~# git clone git@192.168.27.11:duxy6/web1.gitCloning into &#x27;web1&#x27;...remote: Enumerating objects: 3, done.remote: Counting objects: 100% (3/3), done.remote: Total 3 (delta 0), reused 0 (delta 0)Receiving objects: 100% (3/3), done.

2.提交
12345678910111213141516171819202122232425262728293031323334353637383940#对代码做更改root@duxy6:~# echo &quot;welcome to duxy6.com    V2&quot; &gt;&gt; web1/index.html #提交代码root@duxy6:~/web1# git add index.html root@duxy6:~/web1# git ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2019/05/03/CICD/gitlab/gitlab%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/gitlab%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/" title="GitLab简单使用">     <img class="post_bg" src="/images/gitlab.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="GitLab简单使用"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/05/03/CICD/gitlab/gitlab%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/gitlab%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/" title="GitLab简单使用">GitLab简单使用</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2019-05-03T02:10:00.000Z" title="发表于 2019-05-03 10:10:00">2019-05-03</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/CICD/">CICD</a></span></div><div class="content">配置完毕后使用浏览器登录


创建组


创建用户


修改用户密码


将用户添加到组中

创建项目




创建一个文件




克隆项目本地克隆项目，先获取克隆的链接

使用http克隆获得到httpd地址后直接使用git clone来克隆项目
12345678root@duxy6:~# git clone http://192.168.27.11/duxy6/web1.gitCloning into &#x27;web1&#x27;...Username for &#x27;http://192.168.27.11&#x27;: masuriPassword for &#x27;http://masuri@192.168.27.11&#x27;: remote: Enumerating objects: 3, done.remote: Counting objects: 100% (3/3), done.remote: Total 3 (delta 0), reused 0 (delta 0)Unpacking objects: 100% (3/3), done.

使用git ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2019/05/03/CICD/gitlab/gitlab%E9%83%A8%E7%BD%B2/gitlab%E9%83%A8%E7%BD%B2/" title="GitLab部署">     <img class="post_bg" src="/images/gitlab.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="GitLab部署"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/05/03/CICD/gitlab/gitlab%E9%83%A8%E7%BD%B2/gitlab%E9%83%A8%E7%BD%B2/" title="GitLab部署">GitLab部署</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2019-05-03T02:00:00.000Z" title="发表于 2019-05-03 10:00:00">2019-05-03</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/CICD/">CICD</a></span></div><div class="content">GitLab部署在gitlab官网获取gitlab的相应版本的安装包，本次部署的版本为gitlab-ce_11.11.5-ce，使用的linux系统为ubuntu 18.04.2.
gitlab官方下载地址：
https://packages.gitlab.com/gitlab/gitlab-ce
将下载后的安装包上传到linux
12root@duxy6:~# lsgitlab-ce_11.11.5-ce.0_amd64.deb

安装gitlab，getlab对系统有一定的要求要求内存为4G
1root@duxy6:~# dpkg -i gitlab-ce_11.11.5-ce.0_amd64.deb 

修改配置文件
123456789101112131415root@duxy6:~# vim /etc/gitlab/gitlab.rb # 配置url的ip地址external_url &#x27;http://192.168.27.11&#x27;# 配置邮箱gitlab_rails[&#x27;smtp_enable&#x27;] = truegitlab_rails[&#x ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2019/04/21/Httpd/LAMP%E9%AB%98%E7%BA%A7%E6%9E%B6%E6%9E%84/LAMP%E9%AB%98%E7%BA%A7%E6%9E%B6%E6%9E%84/" title="互联网LAMP架构实现（一）">     <img class="post_bg" src="/images/httpd.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="互联网LAMP架构实现（一）"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/04/21/Httpd/LAMP%E9%AB%98%E7%BA%A7%E6%9E%B6%E6%9E%84/LAMP%E9%AB%98%E7%BA%A7%E6%9E%B6%E6%9E%84/" title="互联网LAMP架构实现（一）">互联网LAMP架构实现（一）</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2019-04-20T22:25:02.000Z" title="发表于 2019-04-21 06:25:02">2019-04-21</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Apache/">Apache</a></span></div><div class="content">在互联网上架构如下图所示，本节将演示如何实现以下架构并安装wordpress，此处以DNS作为高可用和负载均衡。






主机类型
主机名
系统
IP



Client
Clinet
Fedora30
192.168.73.153


DNS
DNS
CentOS7.6
192.168.73.101


HTTPD+PHP
HTTPD
CentOS7.6
192.168.73.110


HTTPD+PHP
HTTPD2
CentOS7.6
192.168.73.111


NFS
nfs
CentOS7.6
192.168.73.120


MySQL
Master
CentOS7.6
192.168.73.130


MySQL
Slave1
CentOS7.6
192.168.73.131


MySQL
Slave2
CentOS7.6
192.168.73.132


一、搭建MySQL主从在所有MySQL服务器安装MySQL服务
1yum install mariadb-server -y

Master节点操作1.配置主节点服务器
12345[root@master ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2019/04/20/Httpd/https%E5%8F%8A%E9%87%8D%E5%AE%9A%E5%90%91/https%E5%8F%8A%E9%87%8D%E5%AE%9A%E5%90%91/" title="https及http重定向https">     <img class="post_bg" src="/images/httpd.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="https及http重定向https"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/04/20/Httpd/https%E5%8F%8A%E9%87%8D%E5%AE%9A%E5%90%91/https%E5%8F%8A%E9%87%8D%E5%AE%9A%E5%90%91/" title="https及http重定向https">https及http重定向https</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2019-04-19T22:30:02.000Z" title="发表于 2019-04-20 06:30:02">2019-04-20</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Apache/">Apache</a></span></div><div class="content">http在网络上传输时是明文的，很容易被网络上的黑客抓取到敏感信息，由此产生了加密的http称为https(http over ssl)
要使用https服务器端先要去互联网上的CA申请证书，获取证书后对apache服务加以配置就能使用https加密通讯，HTTPS所使用的端口为443

https的通信过程


https的实现实验环境
准备主机2台，1台充当CA，1台为https服务器



主机
ip地址



CA
192.168.73.111


duxy6.com
192.168.73.110


配置https1.启用ssl模块
要使用https需要启用ssl模块，系统默认没有启动用
12[root@duxy6 ~]# httpd -M | grep ssl[root@duxy6 ~]# yum install mod_ssl -y

2.在CA服务器上为CA创建目录
12[root@ca ~]# mkdir /data/ssl[root@ca ~]# cd /data/ssl

3.生成ca的私钥
12345[root@ca ssl]# (umask 066;opens ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/12/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/#content-inner">12</a><span class="page-number current">13</span><a class="page-number" href="/page/14/#content-inner">14</a><span class="space">&hellip;</span><a class="page-number" href="/page/24/#content-inner">24</a><a class="extend next" rel="next" href="/page/14/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://duxy.oss-cn-shanghai.aliyuncs.com/logo_bk.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Darius</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">232</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">21</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">35</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="http://wpa.qq.com/msgrd?v=3&amp;uin=1184752648&amp;site=qq&amp;menu=yes"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">求职之路 定调：结合兴趣，目标明确，准备充分，一举中的。</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/06/10/Shell/SHELL%E7%BB%83%E4%B9%A0%E9%A2%98/" title="SHELL练习题"><img src="/images/shell.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SHELL练习题"/></a><div class="content"><a class="title" href="/2022/06/10/Shell/SHELL%E7%BB%83%E4%B9%A0%E9%A2%98/" title="SHELL练习题">SHELL练习题</a><time datetime="2022-06-10T07:56:02.000Z" title="发表于 2022-06-10 15:56:02">2022-06-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/10/Shell/SHELL%E8%84%9A%E6%9C%AC%E8%BF%9B%E9%98%B6/" title="SHELL脚本进阶"><img src="/images/shell.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SHELL脚本进阶"/></a><div class="content"><a class="title" href="/2022/06/10/Shell/SHELL%E8%84%9A%E6%9C%AC%E8%BF%9B%E9%98%B6/" title="SHELL脚本进阶">SHELL脚本进阶</a><time datetime="2022-06-10T07:50:02.000Z" title="发表于 2022-06-10 15:50:02">2022-06-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/10/Shell/SHELL%E8%84%9A%E6%9C%AC%E8%BF%9B%E9%98%B6%E7%BB%83%E4%B9%A0/" title="SHELL脚本进阶练习"><img src="/images/shell.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SHELL脚本进阶练习"/></a><div class="content"><a class="title" href="/2022/06/10/Shell/SHELL%E8%84%9A%E6%9C%AC%E8%BF%9B%E9%98%B6%E7%BB%83%E4%B9%A0/" title="SHELL脚本进阶练习">SHELL脚本进阶练习</a><time datetime="2022-06-10T07:46:02.000Z" title="发表于 2022-06-10 15:46:02">2022-06-10</time></div></div></div></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/Ansible/" style="font-size: 1.39em; color: #99a5b5">Ansible</a> <a href="/tags/Apache/" style="font-size: 1.28em; color: #99a0aa">Apache</a> <a href="/tags/DNS/" style="font-size: 1.17em; color: #999ca0">DNS</a> <a href="/tags/Docker/" style="font-size: 1.32em; color: #99a2ae">Docker</a> <a href="/tags/Jenkins/" style="font-size: 1.28em; color: #99a0aa">Jenkins</a> <a href="/tags/Linux%E5%9F%BA%E7%A1%80/" style="font-size: 1.43em; color: #99a6b8">Linux基础</a> <a href="/tags/MySQL/" style="font-size: 1.46em; color: #99a8bc">MySQL</a> <a href="/tags/Nginx/" style="font-size: 1.35em; color: #99a3b1">Nginx</a> <a href="/tags/OpenSSH/" style="font-size: 1.17em; color: #999ca0">OpenSSH</a> <a href="/tags/OpenSSL/" style="font-size: 1.1em; color: #999">OpenSSL</a> <a href="/tags/Shell/" style="font-size: 1.21em; color: #999da3">Shell</a> <a href="/tags/awk/" style="font-size: 1.1em; color: #999">awk</a> <a href="/tags/gitlab/" style="font-size: 1.21em; color: #999da3">gitlab</a> <a href="/tags/grub%E4%BF%AE%E5%A4%8D/" style="font-size: 1.21em; color: #999da3">grub修复</a> <a href="/tags/hexo/" style="font-size: 1.14em; color: #999a9c">hexo</a> <a href="/tags/kubernetes/" style="font-size: 1.5em; color: #99a9bf">kubernetes</a> <a href="/tags/security/" style="font-size: 1.1em; color: #999">security</a> <a href="/tags/%E7%B3%BB%E7%BB%9F%E4%BF%AE%E5%A4%8D/" style="font-size: 1.17em; color: #999ca0">系统修复</a> <a href="/tags/%E7%BD%91%E7%BB%9C/" style="font-size: 1.21em; color: #999da3">网络</a> <a href="/tags/%E8%87%AA%E5%8A%A8%E5%8C%96%E5%AE%89%E8%A3%85%E7%B3%BB%E7%BB%9F/" style="font-size: 1.14em; color: #999a9c">自动化安装系统</a> <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/" style="font-size: 1.25em; color: #999fa7">计算机基础</a></div></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">232</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2022-06-14T05:28:57.868Z"></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By Darius</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a href="https://blog.duxy6.com/">Butterfly</a></br>
<a href="http://www.beian.miit.gov.cn/"  style="color:#f72b07" target="_blank">蒙ICP备19002959号</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-heart.min.js" async="async" mobile="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>